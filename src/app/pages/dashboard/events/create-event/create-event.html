<div class="flex min-h-screen relative">
  <!-- Sidebar -->
  <aside class="w-64 bg-white border-r border-gray-200 p-6 space-y-6 fixed">
    <a
      routerLink="/dashboard/events"
      class="cursor-pointer text-violet-600 font-medium flex items-center gap-2"
    >
      <ng-icon name="ionChevronBack" style="width: 22px; height: 22px" />
      Back to events
    </a>

    <!-- Preview Card -->
    <div class="p-4 rounded-xl shadow-sm border border-gray-200 bg-white">
      <p class="font-semibold text-gray-800">
        {{ createEventForm.value.title || "Event Title" }}
      </p>
      <p class="text-sm text-gray-500 dark:text-gray-400">
        {{ createEventForm.value.event_date || "Fri, Nov 21, 2025" }},
        {{ createEventForm.value.event_time || "10:00 AM" }}
      </p>
      <div class="mt-3">
        <button class="text-gray-700 cursor-pointer border border-gray-300 bg-transparent rounded-md text-sm px-3 py-1">
          Draft
        </button>
        <a href="#" class="ml-3 text-sm text-violet-600 hover:underline"
          >Publish</a
        >
      </div>
    </div>
  </aside>

  <!-- Main Form Area -->
  <main class="flex-1 p-10 overflow-y-auto ml-64 px-30">
    <!-- Upload Area -->
    <div
      class="relative rounded-lg overflow-hidden border-2 border-dashed border-violet-300 bg-violet-50 flex items-center justify-center h-[350px] mb-10 group"
    >
      @if (createEventForm.value.image) {
      <img
        [src]="createEventForm.value.image"
        alt="Event image"
        class="w-full h-full object-fit"
      />
      <button
        (click)="removeImage()"
        class="absolute top-3 right-3 bg-white text-violet-600 hover:bg-red-400 hover:text-white rounded-full p-2 cursor-pointer opacity-0 group-hover:opacity-100 transition-all duration-300 shadow-md"
        title="Remove image"
      >
        <ng-icon name="ionTrashOutline" style="width: 20px; height: 20px" />
      </button>
      } @else {
      <label
        class="cursor-pointer flex flex-col items-center justify-center text-center text-violet-700"
      >
        <input
          type="file"
          hidden
          (change)="onImageSelect($event)"
          accept=".jpg,.jpeg,.png"
        />
        <div
          class="bg-white rounded-md px-5 py-3 shadow-sm border border-violet-200 flex flex-col items-center justify-center"
        >
          <ng-icon name="ionCloudUpload" style="width: 40px; height: 40px" />

          <span class="font-medium">Upload photos and video</span>
        </div>
      </label>
      }
    </div>

    <!-- Event Overview -->
    <section class="bg-white rounded-md p-8 shadow-sm border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Event Overview</h2>

      <form
        class="space-y-6"
        [formGroup]="createEventForm"
      >
        <!-- Event title -->
        <div>
          <label class="block font-semibold mb-2 text-gray-700"
            >Event title *</label
          >
          <input
            formControlName="title"
            name="title"
            type="text"
            required
            placeholder="Event Title"
            class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
          />
        </div>

        <!-- Summary -->
        <div>
          <label class="block font-semibold mb-2 text-gray-700">Summary</label>
          <textarea
            formControlName="description"
            name="description"
            rows="3"
            maxlength="140"
            placeholder="Short description of your event..."
            class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
          ></textarea>
          <p class="text-gray-400 text-xs mt-1">Max 140 characters</p>
        </div>

        <!-- Date / Time / Category -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label class="block font-semibold mb-2 text-gray-700"
              >Event date</label
            >
            <input
              type="date"
              formControlName="event_date"
              name="event_date"
              required
              class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
            />
          </div>
          <div>
            <label class="block font-semibold mb-2 text-gray-700"
              >Event time</label
            >
            <input
              type="time"
              formControlName="event_time"
              name="event_time"
              required
              class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
            />
          </div>
          <div>
            <label class="block font-semibold mb-2 text-gray-700"
              >Category</label
            >
            <input
              type="text"
              formControlName="category"
              name="category"
              placeholder="Workshop, Music, Tech..."
              class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
            />
          </div>
        </div>

        <!-- Location / Capacity -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block font-semibold mb-2 text-gray-700"
              >Location</label
            >
            <input
              type="text"
              formControlName="location"
              name="location"
              placeholder="Accra, Ghana"
              class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
            />
          </div>
          <div>
            <label class="block font-semibold mb-2 text-gray-700"
              >Capacity</label
            >
            <input
              type="number"
              formControlName="capacity"
              name="capacity"
              placeholder="Set event capacity"
              (focus)="openDrawer()"
              [value]="ticketForm.value.quantity"
              readonly
              class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-violet-500 outline-none"
            />
          </div>
        </div>

        <!-- Save Button -->
        <div class="flex justify-end">
          <button
          (click)="onSubmit()"
            type="button"
            class="bg-violet-800 hover:bg-violet-800 cursor-pointer text-white px-6 py-2 rounded-md font-semibold shadow-sm transition"
          >
           @if(loading){Loading...}@else{Save}
          </button>
        </div>
      </form>
    </section>
  </main>
</div>
<div [class.hidden]="!isDrawerOpen" (click)="closeDrawer()" class="z-200 w-full h-screen absolute fixed bg-black top-0 left-0 opacity-[0.5]"></div>
<div
class="fixed top-0 z-200 right-0 w-full sm:w-[400px] h-full bg-white shadow-2xl z-50 transform transition-transform duration-300 ease-in-out"
[class.translate-x-full]="!isDrawerOpen"
>
  <div class="p-6 flex flex-col h-full">
    <h3 class="text-xl font-semibold mb-4">Add Tickets</h3>

    <div class="flex space-x-2 mb-4">
      <button (click)="handleType('Paid')" [class.border-violet-500]="isPaid" class="flex-1 bg-transparent border border-gray-300 rounded-md py-2 font-medium text-slate-800">
        Paid
      </button>
      <button
      (click)="handleType('Free')"
      [class.border-violet-500]="isFree"
        class="flex-1 border border-gray-300 bg-transparent rounded-md py-2 font-medium text-slate-800"
      >
        Free
      </button>
      <button [class.border-violet-500]="isDonation" (click)="handleType('Donation')"  class="flex-1 bg-transparent border border-gray-300 rounded-md py-2 font-medium text-slate-800">
        Donation
      </button>
    </div>

    <form class="flex-1 overflow-y-auto space-y-4 px-2" [formGroup]="ticketForm">
      <div>
        <label class="block text-gray-700 font-medium mb-1">Name</label>
        <input
          type="text"
          formControlName="name"
          class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-violet-500 outline-none"
          placeholder="Could be the name of your Event"
        />
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-1"
          >Available quantity</label
        >
        <input
          type="number"
        class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-violet-500 outline-none"
          placeholder="Enter quantity"
          formControlName="quantity"
          [value]="createEventForm.value.capacity"
        />
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-1">Price</label>
        <input
        formControlName="price"
          type="text"
          [value]="ticketForm.value.type"
          ngClass="{'italic text-slate-400' : ticketForm.value.type !== 'Paid'}"
          placeholder="Enter ticket Price"
          class="placeholder:text-slate-400 placeholder:text-[14px] placeholder:italic w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-violet-500 outline-none"
        />
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-gray-700 font-medium mb-1"
            >Sales start</label
          >
          <input
          formControlName="event_start_date"
            type="date"
            class="w-full border border-gray-300 rounded-md px-3 py-2"
          />
        </div>
        <div>
          <label class="block text-gray-700 font-medium mb-1">Start time</label>
          <input
            formControlName="event_start_time"
            type="time"
            class="w-full border border-gray-300 rounded-md px-3 py-2"
          />
        </div>

        <div>
          <label class="block text-gray-700 font-medium mb-1">Sales end</label>
          <input
            formControlName="event_end_date"
            type="date"
            class="w-full border border-gray-300 rounded-md px-3 py-2"
          />
        </div>
        <div>
          <label class="block text-gray-700 font-medium mb-1">End time</label>
          <input
            formControlName="event_end_time"
            type="time"
            class="w-full border border-gray-300 rounded-md px-3 py-2"
          />
        </div>
      </div>
    </form>

    <div class="flex justify-between mt-6">
      <button
        (click)="closeDrawer()"
        class="px-4 py-2 border border-gray-300 rounded-md font-medium"
      >
        Cancel
      </button>
      <button
       (click)="closeDrawer()"
        class="px-4 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700"
      >
        Save
      </button>
    </div>
  </div>
</div>
